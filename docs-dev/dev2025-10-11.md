# dev2025-10-11

## –ò—Å—Ö–æ–¥–Ω–∞—è –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–æ–ø—Ä–æ—Å–∞

–ï—Å—Ç—å –≤–µ–± –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

- Java: Oracle Java 1.8 x64
- –§—Ä–µ–π–º–≤–æ—Ä–∫–∏: Spring 5.2.8.RELEASE, Jersey 1.19.4 (JAX-RS —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
- –°–±–æ—Ä–∫–∞: Gradle 6.8.2 + Groovy
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: JUnit 4.12, Jersey Test Framework —Å Grizzly –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º
- –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
  - Lombok 1.18.20
  - Google Guava 20.0
  - org.apache.logging.log4j:log4j-api:2.4 + SLF4J
  - Jersey 1.19.4 (jersey-bundle, jersey-json, jersey-spring)
  - JAXB API 2.3.1
  - com.sun.jersey.jersey-test-framework:jersey-test-framework-grizzly:1.19.4
- —Ç–µ—Å—Ç–æ–≤—ã–π –∫–ª–∞—Å—Å PublicControllerIntegrationTest.java –Ω–∞ –±–∞–∑–µ JerseyTest

```java
//–≤—Å—Ç–∞–≤–∏—Ç—å
//src/test/java/mil/teng254/legacy/controller/PublicControllerIntegrationTest.java 
```

–ó–∞–¥–∞—á–∞: –∏–∑–º–µ–Ω–∏—Ç—å –ø—Ä–æ—Ü–µ–¥—É—Ä—É –∑–∞–ø—É—Å–∫–∞ Grizzly, —á—Ç–æ–±—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–æ –≤
–æ–¥–Ω–æ–º —ç–∫–∑–µ–º–ø–ª—è—Ä–µ –∏ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–ª–∏—Å—å –¥–≤–∞ tcp-–ø–æ—Ä—Ç–∞ (–Ω–∞ –æ–±–æ–∏—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è HTTP
–ø—Ä–æ—Ç–æ–∫–æ–ª). –ù–æ–º–µ—Ä–∞ –ø–æ—Ä—Ç–æ–≤ –∑–∞–¥–∞—é—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—ã - MAIN_PORT –∏
SPECIAL_PORT.
–ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã –Ω–µ –∑–∞–¥–∞–Ω—ã - —Ç–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –ø–∞–¥–∞—Ç—å.
–¢–∞–∫–∂–µ —ç—Ç–∏ –Ω–æ–º–µ—Ä–∞ –ø–æ—Ä—Ç–æ–≤ (–∑–∞–¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Å—Ä–µ–¥—ã) –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ —Ç–µ—Å—Ç–∞—Ö.
–û—Ç–≤–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ –∏–Ω–æ–µ.
–ï—Å–ª–∏ –Ω—É–∂–Ω—ã —É—Ç–æ—á–Ω–µ–Ω–∏—è –∏–ª–∏ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ - –∑–∞–¥–∞–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã.

## –†–µ—à–µ–Ω–∏–µ-1. –ú–Ω–æ–≥–æ–ø–æ—Ä—Ç–æ–≤—ã–π Grizzly1

–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è: GrizzlyWebTestContainerFactory - —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏ –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å,
—á—Ç–æ–±—ã GrizzlyWebTestContainer —Å–æ–∑–¥–∞–≤–∞–ª –¥–≤–∞ —Å–ª—É—à–∞—Ç–µ–ª—è

–æ—à–∏–±–∫–∞: –ø—Ä–∏–≤–æ–¥–∏—Ç—Å—è –∫–æ–¥ GrizzlyWebTestContainerFactory –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π Jersey 1.19.4
–ø—Ä–∏–º–µ—Ä: HttpServer.createSimpleServer.

## –†–µ—à–µ–Ω–∏–µ-2. –ú–Ω–æ–≥–æ–ø–æ—Ä—Ç–æ–≤—ã–π Tomcat Embedded

### üéØ –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞

**Legacy –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** —Å–æ —Å—Ç–µ–∫–æ–º:

- **Java**: Oracle Java 1.8 x64
- **–§—Ä–µ–π–º–≤–æ—Ä–∫–∏**: Spring 5.2.8.RELEASE, Jersey 1.19.4 (JAX-RS)
- **–°–±–æ—Ä–∫–∞**: Gradle 6.8.2 + Groovy
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: JUnit 4.12, Lombok 1.18.20

### üöÄ –ü—Ä–∏–Ω—è—Ç—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

#### 1. –ú–Ω–æ–≥–æ–ø–æ—Ä—Ç–æ–≤—ã–π embedded Tomcat –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:

- –ó–∞–ø—É—Å–∫ —Å –¥–≤—É–º—è TCP-–ø–æ—Ä—Ç–∞–º–∏ (MAIN_PORT + SPECIAL_PORT)
- –ü—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–º–µ—Å—Ç–æ server.xml
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏
- –ü–æ–ª–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –≤ —Ç–µ—Å—Ç–∞—Ö

#### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Jersey —á–µ—Ä–µ–∑ web.xml

```xml
<servlet>
<!-- –ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã -->
  <init-param>
    <param-name>com.sun.jersey.config.property.packages</param-name>
    <param-value>mil.teng254.legacy.controller,mil.teng254.legacy.filter</param-value>
  </init-param>
  <init-param>
    <param-name>com.sun.jersey.api.json.POJOMappingFeature</param-name>
    <param-value>false</param-value>
  </init-param>
</servlet>
```

#### 3. –ö–∞—Å—Ç–æ–º–Ω–∞—è JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è

```java
@Provider
@Produces(MediaType.APPLICATION_JSON)
public class JAXBContentResolver implements ContextResolver<JAXBContext> {
    // –Ø–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ JAXB –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–ª—å–∫–æ @XmlRootElement –∫–ª–∞—Å—Å–æ–≤
    // –ò–∑–æ–ª—è—Ü–∏—è –ø–∞–∫–µ—Ç–æ–≤: mil.teng254.legacy.dto
}
```

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```text
src/test/resources/tomcat-config/
‚îî‚îÄ‚îÄ web.xml                    # –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
```

#### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ)

```bash
MAIN_PORT=8080        # –û—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ä—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
SPECIAL_PORT=1414     # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ—Ä—Ç –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
```

#### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Ç–µ—Å—Ç–æ–≤

```text
@BeforeClass ‚Üí EmbeddedTomcatServer.start()
@Before ‚Üí Spring RequestContext –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è  
@Test ‚Üí –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –æ–±–æ–∏–º –ø–æ—Ä—Ç–∞–º
@After ‚Üí –û—á–∏—Å—Ç–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
@AfterClass ‚Üí EmbeddedTomcatServer.stop()
```

### üí° –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

#### –†–∞–±–æ—Ç–∞ —Å JSON

- **–û—Ç–∫–ª—é—á–µ–Ω** POJOMappingFeature –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π
- **JAXBContentResolver** –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—É—é —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é
- **–Ø–≤–Ω–∞—è –ø—Ä–∏–≤—è–∑–∫–∞** —Ç–æ–ª—å–∫–æ –∫ –∫–ª–∞—Å—Å–∞–º —Å @XmlRootElement

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç–∞–º–∏

- **–ü—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** Connector'–æ–≤ –≤–º–µ—Å—Ç–æ server.xml
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ** –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –∫–∞—Ç–∞–ª–æ–≥–æ–≤
- **–ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è** —Ç–µ—Å—Ç–æ–≤—ã—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤

#### Spring Context –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

- **WebApplicationContext** –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ test-applicationContext.xml
- **MockHttpServletRequest/Response** –¥–ª—è —ç–º—É–ª—è—Ü–∏–∏ –≤–µ–±-–æ–∫—Ä—É–∂–µ–Ω–∏—è
- **RequestContextHolder** –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –ø–æ—Ç–æ–∫–∞–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### üéØ –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –±—É–¥—É—â–∏—Ö –¥–æ—Ä–∞–±–æ—Ç–æ–∫

#### –î–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å EmbeddedTomcatServer –∫–∞–∫ –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å
- –ù–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é web.xml –∏–∑ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
- –°–æ–±–ª—é–¥–∞—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è MAIN_PORT/SPECIAL_PORT

#### –î–ª—è —Ä–∞–±–æ—Ç—ã —Å JSON

- –†–∞—Å—à–∏—Ä—è—Ç—å JAXBContentResolver –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö DTO
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å POJOMappingFeature=false –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —è–≤–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –≤–º–µ—Å—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö

#### –î–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Jersey

- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –ø–∞–∫–µ—Ç–æ–≤: **–∑–∞–ø—è—Ç–∞—è** –≤ com.sun.jersey.config.property.packages
- –Ø–≤–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤ web.xml
- –û—Ç–∫–ª—é—á–µ–Ω–∏–µ WADL –¥–ª—è —á–∏—Å—Ç–æ—Ç—ã API

–≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ legacy-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –ø–æ–ª–Ω—ã–º
–∫–æ–Ω—Ç—Ä–æ–ª–µ–º –Ω–∞–¥ –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–π —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π –¥–∞–Ω–Ω—ã—Ö.
